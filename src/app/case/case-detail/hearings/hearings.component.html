<loading-bar [visible]="loadingDataFlag" [message]="'loading hearing data...'"></loading-bar>

<div class="ui-g-12">

  <div class="ui-g-12 ph-0 pt-0">
    <div class="ui-g-6 pad-0">
      <h2>Hearings</h2>
    </div>
    <div class="ui-g-6 pad-0 ta-r">
      <button type="button"
          *ngIf="hasPermission(Permission.CREATE_CASE_HEARING)"
          (click)="createHearing(hearingForm)"
          label="New Hearing"
          icon="ui-icon-add"
          class="ui-button-secondary mt-10" pButton></button>
    </div>

  </div>

  <!-- Column 1 -->
  <div class="ui-g-3 ui-sm-12 pl-0 pr-30">

    <p-dataTable [value]="hearings"
                selectionMode="single"
                [(selection)]="selectedHearing"
                (onRowSelect)="hearingOnRowSelect($event)"
                scrollable="true" scrollHeight="360px"
                dataKey="id" #dtHearings>
      <p-column field="" header="Hearings" >
        <ng-template pTemplate="body" let-item="rowData">
          <h4 class="mb-10 mt-0">{{ item.hearingType.name }}</h4>
          <p class=" mv-0" >{{ item.judicialOfficer.firstName }} {{ item.judicialOfficer.lastName }}</p>
          <p class=" mv-0" >{{ item.hearingStartDateTime | date:'MMM d, yyyy h:mm a' }} </p>
        </ng-template>
      </p-column>
    </p-dataTable>
  </div>

  <!-- Column 2 -->
  <div class="ui-g-9 ui-sm-12">


    <!-- BEGIN FORM GROUP ----------------- -->

    <form (ngSubmit)="saveHearing()" #hearingForm="ngForm" novalidate>
      <div class="ui-g">
        <div class="form-group" >

          <div class="ui-g-3 ui-sm-12">
            <!-- HEARING DATE -->
            <label class="minimal primary block">Hearing Date</label>
            <p-calendar id="hearingDate" name="hearingDate" #hearingDate="ngModel" placeholder="Hearing Date"
                [ngModel]="selectedHearing?.startDateTime"
                (ngModelChange)="hearingDateOnChange($event)"
                [showIcon]="true"
                dateFormat="mm/dd/yy"
                appendTo="body"></p-calendar>
            <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="hearingDate.errors?.required && hearingDate.touched" >
                  Please choose a Hearing Date
            </div>
          </div>

          <div class="ui-g-9 ui-sm-12 ph-0">
            <div class="ui-g-6 mb-20">
              <label class="minimal primary block">Hearing Type</label>
              <p-dropdown name="ddHearingType" id="ddHearingType" #ddHearingType="ngModel" placeholder="choose Hearing Type..."
                  [required]="true"
                  [options]="hearingTypes"
                  optionLabel="hearingName"
                  [ngModel]="selectedHearing?.hearingTypeId"
                  (onChange)="hearingTypeOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="ddHearingType.errors?.required && ddHearingType.touched" >
                    Please choose a Hearing Location
              </div>
            </div>
            <div class="ui-g-6 mb-20">
              <label class="minimal primary block">Hearing Location</label>
              <p-dropdown name="ddHearingLocation" id="ddHearingLocation" #ddHearingLocation="ngModel" placeholder="choose Hearing Location..."
                  [required]="true"
                  [options]="hearingLocations"
                  optionLabel="locationID"
                  [ngModel]="selectedHearing?.courtLocationId"
                  (onChange)="hearingLocationOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="ddHearingLocation.errors?.required && ddHearingLocation.touched" >
                    Please choose a Hearing Location
              </div>
            </div>
            <div class="ui-g-6 mb-20">
              <label class="minimal primary block">Judicial Officer</label>
              <p-dropdown name="ddHearingJudge" id="ddHearingJudge" #ddHearingJudge="ngModel" placeholder="choose Judgicial Officer..."
                  [required]="true"
                  [options]="judges | dropdownPipe: ['firstName', 'lastName'] : 'partyOID' : 'choose Judge...'"
                  [ngModel]="selectedHearing?.judicialOfficerId"
                  (onChange)="hearingJudgeOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="ddHearingJudge.errors?.required && ddHearingJudge.touched" >
                    Please select a Judicial Officer
              </div>
            </div>

            <div class="ui-g-12">
                <label class="minimal primary block">Description</label>
                <textarea name="tiHearingDescription"
                          [ngModel]="selectedHearing?.description"
                          (ngModelChange)="hearingDescriptionOnChange($event)"
                          [rows]="2"
                          pInputTextarea
                          autoResize="autoResize"
                          class="width-full"></textarea>
              </div>
            </div>


          </div>

          <!-- <div class="ui-g-12 ph-0">
            <div class="ui-g-12 ui-md-6 ta-r">
                <label class="minimal primary block ta-c">Start Time</label>
                <p-calendar id="hearingStartTime" name="hearingStartTime" #hearingStartTime="ngModel" placeholder="Start Time"
                    [ngModel]="selectedHearing?.startDateTime"
                    (ngModelChange)="hearingStartTimeOnChange($event)"
                    [inline]="true"
                    hourFormat="12"
                    [timeOnly]="true"
                    class="time-picker"></p-calendar>
                <div class="ui-message ui-messages-error ui-corner-all"
                      *ngIf="hearingStartTime.errors?.required && hearingStartTime.touched" >
                      Please choose a Start Time
                </div>
            </div>

            <div class="ui-g-12 ui-md-6">
              <label class="minimal primary block ta-c">End Time</label>
              <p-calendar id="hearingEndTime" name="hearingEndTime" #hearingEndTime="ngModel" placeholder="End Time"
                  [ngModel]="selectedHearing?.endDateTime"
                  (ngModelChange)="hearingEndTimeOnChange($event)"
                  [inline]="true"
                  hourFormat="12"
                  [timeOnly]="true"
                  class="time-picker"></p-calendar>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="hearingEndTime.errors?.required && hearingEndTime.touched" >
                    Please choose a End Time
              </div>
            </div>
          </div> -->

        </div>





    </form>
    <!-- // END FORM GROUP ------------------ -->


    <!-- <div class="ui-g-12 pt-20">
      <h2>{{selectedResource.name}}</h2>
    </div> -->

    <!-- <div class="ui-g-12">
      <div class="ui-g-3">
        <label class="minimal primary block">Work Week</label>
        <p-calendar id="dtWorkWeek" name="dtWorkWeek" #dtWorkWeek
              styleClass="larger"
              [required]="false"
              [disabled]="false"
              [(ngModel)]="selectedWorkWeek"
              (onSelect)="onSelectWorkWeek($event)"
              dateFormat="mm/dd/yy"
              placeholder="Work Week"
              [showIcon]="true"
              yearRange="2018:2038"
              [yearNavigator]="false"
              appendTo="body" ></p-calendar>
              <!-- (onSelect)="generalDetailsOnBlur($event)"
      </div>
    </div> -->

    <div class="ui-g-12">
      <div class="" *ngIf="selectedHearing">
        <!-- CALENDAR -->
        <daypilot-scheduler [config]="config" [events]="selectedHearing.days" #scheduler></daypilot-scheduler>
        <p class="mv-0 muted-label">Click and drag to mark hours. </p>
      </div>
      <div class="ta-r">

        <div class="ui-g-12 mt-30">
          <button label="Save Hearing" type="submit" pButton icon="fa-check" [disabled]="!hearingForm.form.valid"></button>
          <button label="Cancel" class="ui-button-secondary" type="button" pButton icon="fa-close"
                  (click)="onCancelEditHearing(hearingForm)" ></button>
        </div>

        <!-- <button mat-button color="warn" (click)="deleteDataItemRequest()" class="mt-30 fl">
          <mat-icon aria-label="Add resource button">delete</mat-icon>
          Delete Resource Hours
        </button>
        <button mat-raised-button color="primary" (click)="saveItem()" class="mt-30">
          <mat-icon aria-label="Add resource button">check</mat-icon>
          Save Resource
        </button>
        <button mat-button color="secondary" (click)="cancelDataItemEdit()" class="mt-30">
          <mat-icon aria-label="Add resource button">clear</mat-icon>
          Cancel
        </button> -->


      </div>
    </div>
    <div class="ui-g-12">
        <pre>{{selectedResource | json}}</pre>
    </div>
  </div>

    <!-- ---------------- MODALS ---------------- -->

    <p-dialog header="Confirm Delete?" width="450" [(visible)]="showDeleteItemModal" [responsive]="true" showEffect="fade" [modal]="true"
      [closable]="false">
      <div>Are you sure you want to delete this item?</div>
      <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix">
          <button label="No" type="button" pButton icon="fa-close" (click)="hideModals()"></button>
          <button label="Yes" type="button" pButton icon="fa-check" (click)="deleteDataItem()"></button>
        </div>
      </p-footer>
    </p-dialog>


</div>
