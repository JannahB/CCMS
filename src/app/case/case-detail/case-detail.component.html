<p-message *ngIf="staticMessage.visible" severity="{{staticMessage.severity}}" text="{{staticMessage.message}}"></p-message>

<div class="ui-g">
  <!-- HEADER -->
  <div class="ui-g-12 pv-0 pl-0">
    <div class="ui-g-12 ui-md-8">
      <label class="minimal block mb-0">Case:</label>
      <h1 class="page-header mt-0">{{case?.caseNumber}}</h1>
    </div>

  </div>

  <!-- FIRST SECTION -->
  <div class="ui-g-12 card">

    <loading-bar [visible]="loadingCase" [message]="loadingMessage"></loading-bar>

    <div class="ui-g-12 ph-10">
      <div class="ui-g-12 ui-md-8">
          <h2 class="mb-0">Case Details</h2>
      </div>
      <div class="ui-g-12 ui-md-4 ta-r pb-0">

        <!-- <p-progressSpinner strokeWidth="4" [style]="{width: '30px', height: '30px'}"></p-progressSpinner> -->

        <button type="button"
                (click)="saveCase()"
                label="Save Case"
                icon="ui-icon-check"
                class="btn-big" pButton
                [disabled]="!caseForm.form.valid"></button>
      </div>
    </div>

    <div class="ui-g-12 ">
      <form #caseForm="ngForm" novalidate>
        <div *ngIf="case">

          <div class="ui-g-12 ui">
            <div class="ui-g-12 ui-md-3">
              <label class="minimal primary block">Filing Date</label>
              <p-calendar id="dtFilingDate" name="dtFilingDate" #dtFilingDate
                    [required]="true"
                    [disabled]="case.caseOID != 0"
                    [(ngModel)]="case.caseFilingDate"
                    dateFormat="mm/dd/yy"
                    placeholder="Case Filing Date"
                    [showIcon]="true"
                    yearRange="2000:2030"
                    [yearNavigator]="true"
                    appendTo="body" ></p-calendar>
                    <!-- (onSelect)="generalDetailsOnBlur($event)" -->
              <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="dtFilingDate.errors?.required && dtFilingDate.touched" >
                    Please choose a Filing Date
              </div>
            </div>

            <div class="ui-g-12 ui-md-3">
                <label class="minimal block primary">Case Weight</label>
                <div class="mar-0">{{ case.caseWeight }}</div>
                <p-slider name="slCaseWeight" #slCaseWeight="ngModel" [required]="true" min="1" [(ngModel)]="case.caseWeight" [style]="{'width':'100%'}" [min]="0" [max]="10" [animate]="true"></p-slider>
                <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="slCaseWeight.errors?.min && slCaseWeight.touched" >
                      Please choose a Case Weight
                </div>
            </div>
          </div>

          <div class="ui-g-12 ui">

            <div class="ui-g-12 ui-md-4">
              <label class="minimal primary block">Case Status</label>
              <p-dropdown name="ddCaseStaus" #ddCaseStaus placeholder="case status..."
                  [required]="true"
                  optionLabel="name"
                  [options]="caseStatuses"
                  [(ngModel)]="case.caseStatus"
                  (onChange)="ddOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="ddCaseStaus.errors?.required && ddCaseStaus.touched" >
                    Please choose a Case Status
              </div>
            </div>

            <div class="ui-g-12 ui-md-4">
              <label class="minimal primary block">Case Type</label>
              <p-dropdown name="ddCaseType" #ddCaseType placeholder="case type..."
                  [required]="true"
                  [disabled]="case.caseOID != 0"
                  optionLabel="name"
                  [options]="caseTypes"
                  [(ngModel)]="case.caseType"
                  (onChange)="caseTypeChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="ddCaseType.errors?.required && ddCaseType.touched" >
                    Please choose a Case Type
              </div>
            </div>

            <div class="ui-g-12 ui-md-4">
              <label class="minimal primary block">Case Phase</label>
              <p-dropdown name="ddCasePhase" #ddCasePhase placeholder="case phase..."
                  [required]="true"
                  [disabled]="!casePhases || !case.caseType || case.caseOID != 0"
                  (click)="isCaseTypeSelected($event)"
                  optionLabel="name"
                  [options]="casePhases"
                  [(ngModel)]="case.casePhase"
                  (onChange)="ddOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="ddCasePhase.errors?.required && ddCasePhase.touched" >
                    Please choose a Case Phase
              </div>
            </div>
          </div>


          <!-- CASE PARTIES TABLE -->

          <div class="ui-g-12 mt-20 ph-0">

            <div class="ui-g-12 ui-md-6">
              <h2 class="mb-10">Case Parties</h2>
            </div>

            <div class="ui-g-12 ui-md-6 ta-r">
              <button type="button"
                  (click)="showAddCaseParty();"
                  label="Add Case Party"
                  icon="ui-icon-add"
                  class="ui-button-secondary mr-15" pButton></button>
            </div>

            <div class="ui-g-12">
              <p-dataTable [value]="case.caseParties"
                          selectionMode="single"
                          [(selection)]="selectedParty"
                          (onRowSelect)="partyOnRowSelect($event)"
                          dataKey="caseParty.partyOID" #dtParties>
                <p-column field="role.name" header="Role" [style]="{'width':'10%'}"></p-column>
                <p-column field="caseParty.firstName" header="First Name" [style]="{'width':'15%'}"></p-column>
                <p-column field="caseParty.lastName" header="Last Name" [style]="{'width':'15%'}"></p-column>
                <p-column field="caseParty.sex" header="Sex" [style]="{'width':'7%'}"></p-column>
                <p-column field="caseParty.dob" header="Date of Birth" [style]="{'width':'13%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{item.dob | date:'M/d/yyyy'}}
                    </ng-template>
                </p-column>
                <p-column field="caseParty.age" header="Age" [style]="{'width':'7%'}"></p-column>
                <p-column field="startDate" header="Start Date" [style]="{'width':'13%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{item.startDate | date:'M/d/yyyy'}}
                    </ng-template>
                </p-column>
                <p-column field="endDate" header="End Date" [style]="{'width':'13%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{item.endDate | date:'M/d/yyyy'}}
                    </ng-template>
                </p-column>
                <!-- <p-column styleClass="col-button" header="Delete" [style]="{'width':'8%'}">
                    <ng-template let-item="rowData" pTemplate="body">
                        <i class="material-icons delete-icon" (click)="requestDeleteParty(item)">delete</i>
                    </ng-template>
                </p-column> -->
              </p-dataTable>
            </div>
          </div>




          <!-- CHARGES TABLE -->

          <div class="ui-g-12 mt-30">

            <div class="ui-g-12 ui-md-6">
              <h2 class="mb-10">Charges</h2>
            </div>
            <div class="ui-g-12 ui-md-6 ta-r">
              <button type="button"
                    (click)="onAddCaseCharge(caseChargeForm)"
                    label="Add Case Charge"
                    icon="ui-icon-add"
                    class="ui-button-secondary mr-15" pButton></button>
            </div>

            <div class="ui-g-12">

              <!--
                ******** NEW TABLE ***********
                Waiting for Aaron to add the
                dependency tree in case data
                ******************************
              -->
              <!-- <p-dataTable [value]="case.caseCharges"
                          selectionMode="single"
                          [(selection)]="selectedCharge"
                          (onRowSelect)="caseOnRowSelect($event)"
                          dataKey="caseChargeOID" #dtCharges>
                <p-column header="#" field="" [style]="{'width':'12%'}">
                  <ng-template pTemplate="body" let-n="rowIndex">
                    {{n+1}}
                  </ng-template>
                </p-column>
                <p-column header="Section" field="iccsCode.categoryIdentifier" [style]="{'width':'12%'}"></p-column>
                <p-column header="Division" field="" [style]="{'width':'12%'}"></p-column>
                <p-column header="Group" field="" [style]="{'width':'12%'}"></p-column>
                <p-column header="Class" field="" [style]="{'width':'12%'}"></p-column>
                <p-column header="Charge/Law" field="localCharge.localCharge" [style]="{'width':'30%'}"></p-column>
                <p-column header="Lead Charge Description" field="leaChargingDetails" [style]="{'width':'15%'}"></p-column>
                <p-column header="Charge Factors" field="" [style]="{'width':'25%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                      <div *ngFor="let factor of item.chargeFactors; let i = index">
                        {{i+1}}) {{factor.description}}
                      </div>
                    </ng-template>
                </p-column>
                <p-column header="Start Date" field="" [style]="{'width':'12%'}"></p-column>
                <p-column header="End Date"   field="" [style]="{'width':'12%'}"></p-column>

                <p-column header="Delete" styleClass="col-button" [style]="{'width':'8%'}">
                    <ng-template let-item="rowData" pTemplate="body">
                        <i class="material-icons delete-icon" (click)="requestDeleteCharge(item)">delete</i>
                    </ng-template>
                </p-column>
              </p-dataTable> -->


              <p-dataTable [value]="case.caseCharges"
                          selectionMode="single"
                          [(selection)]="selectedCharge"
                          (onRowSelect)="caseOnRowSelect($event)"
                          dataKey="caseChargeOID" #dtCharges>
                <p-column field="iccsCode.categoryIdentifier" header="UN Code" [style]="{'width':'7%'}"></p-column>
                <p-column field="iccsCode.categoryName" header="Description" [style]="{'width':'15%'}"></p-column>
                <p-column field="leaChargingDetails" header="Charge Description" [style]="{'width':'15%'}"></p-column>
                <p-column field="" header="Charge Factors" [style]="{'width':'25%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                      <div *ngFor="let factor of item.chargeFactors; let i = index">
                        {{i+1}}) {{factor.description}}
                      </div>
                    </ng-template>
                </p-column>
                <p-column field="localCharge.localCharge" header="Charge/Law" [style]="{'width':'30%'}"></p-column>
                <!-- <p-column styleClass="col-button" header="Delete" [style]="{'width':'8%'}">
                    <ng-template let-item="rowData" pTemplate="body">
                        <i class="material-icons delete-icon" (click)="requestDeleteCharge(item)">delete</i>
                    </ng-template>
                </p-column> -->
              </p-dataTable>
            </div>
          </div>


          <!-- CASE SAVE BUTTON -->
          <div class="ui-g-12 ta-r">
            <button type="button"
                (click)="saveCase()"
                label="Save Case"
                icon="ui-icon-check"
                class="btn-big" pButton
                [disabled]="!caseForm.form.valid"></button>
          </div>

        </div>
      </form>
    </div>
  </div>
  <!-- //END FISRT CARD -->


  <!-- SECOND CARD - TAB SECTION -->
  <div class="ui-g-12 card" *ngIf="case && case.caseOID && case.caseOID > 0">

    <div *ngIf="case">

      <p-tabView [activeIndex]="activeTabIndex">

        <!-- EVENTS TAB -->

        <p-tabPanel header="Register" leftIcon="ui-icon-list">
          <div class="ui-g">
            <div class="ui-g-12 ui-md-6">
              <h2>Case Events</h2>
            </div>
            <div class="ui-g-12 ui-md-6">
              <label class="minimal primary block">Category Filter</label>
              <p-dropdown
                  placeholder="category filter..."
                  [options]="eventTypes"
                  [(ngModel)]="eventTypeFilter"
                  optionLabel="eventTypeName"
                  (onChange)="eventTypeFilterChange($event)"
                  styleClass="width-auto">
              </p-dropdown>
              <button label="" type="button" class="ml-10 ui-button-secondary ui-button-icon-only clear-btn inline" pButton icon="fa-close" (click)="clearEventFilter()"></button>
            </div>

            <div class="ui-g-12">
              <p-dataTable [value]="filteredEvents"
                          selectionMode="single"
                          [(selection)]="caseEvent"
                          (onRowSelect)="caseEventOnRowSelect($event)"
                          dataKey="caseEventOID" #dtCaseEvents>
                <p-column field="eventDate" header="Date/Time" [style]="{'width':'13%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{item.eventDate | date:'medium'}}
                    </ng-template>
                </p-column>
                <p-column field="eventType.eventCategoryText" header="Event Category" [style]="{'width':'8%'}"></p-column>
                <p-column field="eventType.eventTypeName" header="Event ID" [style]="{'width':'8%'}"></p-column>
                <p-column field="eventType.description" header="Event Description" [style]="{'width':'25%'}"></p-column>
                <p-column field="document.documentName" header="Document" styleClass="text-break" [style]="{'width':'35%'}"></p-column>
                <p-column styleClass="col-button" header="View" [style]="{'width':'7%'}">
                    <ng-template let-item="rowData" pTemplate="body">
                        <i class="material-icons" (click)="requestViewCaseEvent(item)">search</i>
                    </ng-template>
                </p-column>
              </p-dataTable>

            </div>
            <div class="ui-g-12">
              <button type="button"
                  (click)="addCaseEventClicked()"
                  label="Add Completed Event"
                  icon="ui-icon-add"
                  class="ui-button-secondary mr-15" pButton></button>
            </div>
          </div>
        </p-tabPanel>


        <!-- TASKS TAB -->

        <p-tabPanel header="Tasks" leftIcon="ui-icon-timer">
          <div class="ui-g">
            <div class="ui-g-12">
              <h2>Tasks</h2>
            </div>

            <div class="ui-g-12">
              <p-dataTable [value]="case.caseTasks"
                          selectionMode="single"
                          [(selection)]="selectedCaseTask"
                          (onRowSelect)="taskOnRowSelect($event)"
                          dataKey="taskOID" #dtTasks>
                <p-column field="dueDate" header="Due Date" [style]="{'width':'13%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{item.dueDate | date:'M/d/yyyy'}}
                    </ng-template>
                </p-column>
                <p-column field="taskPriorityCode" header="Priority" [style]="{'width':'12%'}"></p-column>
                <p-column field="" header="Assigned" [style]="{'width':'30%'}">
                  <ng-template pTemplate="body" let-item="rowData">
                      <div *ngIf="item.assignedParty?.partyOID">
                        {{ 'Party: ' + item.assignedParty.firstName + ' ' + item.assignedParty.lastName }}
                      </div>
                      <div *ngIf="item.assignedPool?.poolOID">
                        {{ 'Pool: ' + item.assignedPool.poolName }}
                      </div>
                  </ng-template>
                </p-column>
                <p-column field="taskType.name" header="Task Type" [style]="{'width':'38%'}"></p-column>
                <p-column styleClass="col-button" header="View" [style]="{'width':'7%'}">
                    <ng-template let-item="rowData" pTemplate="body">
                        <i class="material-icons" (click)="requestViewTask(item)">search</i>
                    </ng-template>
                </p-column>
              </p-dataTable>

            </div>
            <div class="ui-g-12">
              <button type="button"
                  (click)="createCaseTask()"
                  label="Add Case Task"
                  icon="ui-icon-add"
                  class="ui-button-secondary mr-15" pButton></button>
            </div>
          </div>
        </p-tabPanel>

        <!-- DOCUMENTS TAB  -->

        <p-tabPanel header="Documents" leftIcon="ui-icon-insert-drive-file" >
          <div class="ui-g">
            <div class="ui-g-12">
                <h2>Documents</h2>
            </div>
            <div class="ui-g-12 pt-0">
                <div class="ui-g-12 ui-md-3">
                    <label class="minimal primary block">Generate Document</label>
                    <!-- TODO: Get document types lookup data -->
                    <p-dropdown
                        placeholder="document type..."
                        [options]="documentTemplateTypes"
                        [(ngModel)]="selectedDocumentTemplateType"
                        optionLabel="documentName"
                        (onChange)="ddOnChange($event)"
                        styleClass="width-full">
                    </p-dropdown>
                </div>
                <div class="ui-g-12 ui-md-3 pb-0">
                    <button type="button"
                        (click)="generateDoc()"
                        label="Generate"
                        icon="ui-icon-settings-applications"
                        class="ui-button-secondary inline" pButton></button>
                </div>

                <!-- FILE UPLOAD -->
                <div class="ui-g-12 ui-md-6 pb-0 ta-r">
                  <p-fileUpload name="theFiles[]" url="{{baseURL}}GetAttachment" (onUpload)="onUpload($event)"
                      multiple="multiple" accept="application/pdf" maxFileSize="5000000">
                      <!-- accept="*.doc, *.docx, application/pdf" -->
                      <ng-template pTemplate="content">
                          <ul *ngIf="uploadedFiles.length">
                              <li *ngFor="let file of uploadedFiles">{{file.name}} - {{file.size}} bytes</li>
                          </ul>
                      </ng-template>
                  </p-fileUpload>
                </div>
            </div>

            <div class="ui-g-12">
                <p-dataTable [value]="case.caseDocs"
                            selectionMode="single"
                            [(selection)]="selectedDoc"
                            (onRowSelect)="docOnRowSelect($event)"
                            dataKey="documentOID" #dtDocs>
                    <p-column field="lastUpdateDate" header="Document Date" [style]="{'width':'25%'}">
                        <ng-template pTemplate="body" let-item="rowData">
                            {{item.lastUpdateDate | date:'medium'}}
                        </ng-template>
                    </p-column>
                    <p-column field="" header="Document Name" [style]="{'width':'75%'}">
                        <ng-template pTemplate="body" let-item="rowData" styleClass="text-break">
                            <span>
                                <a href="{{baseURL + '/GetDocument?' + item.documentURL}}" target="_blank">{{item.documentName}}</a>
                            </span>
                            <div style="font-size:10px">{{baseURL + 'GetDocument?' + item.documentURL}}</div>
                        </ng-template>
                    </p-column>
                </p-dataTable>
            </div>
          </div>
        </p-tabPanel>

        <!-- HEARINGS TAB -->

        <p-tabPanel header="Hearings" leftIcon="ui-icon-gavel" >
          <div class="ui-g">
            <div class="ui-g-12">
                <h2>Hearings</h2>
            </div>

            <div class="ui-g-12">
              <p-dataTable [value]="case.caseHearings"
                          selectionMode="single"
                          [(selection)]="selectedHearing"
                          (onRowSelect)="hearingOnRowSelect($event)"
                          dataKey="caseHearingOID" #dtHearings>
                  <p-column field="startDateTime" header="Start Date/Time" [style]="{'width':'17%'}">
                      <ng-template pTemplate="body" let-item="rowData">
                          {{item.startDateTime | date:'MM/dd/yy hh:mm a'}}
                      </ng-template>
                  </p-column>
                  <p-column field="endDateTime" header="End Date/Time" [style]="{'width':'17%'}">
                      <ng-template pTemplate="body" let-item="rowData">
                          {{item.endDateTime | date:'MM/dd/yy hh:mm a'}}
                      </ng-template>
                  </p-column>

                  <p-column field="hearingType.hearingName" header="Hearing Type" [style]="{'width':'25%'}"></p-column>
                  <p-column field="courtLoc.locationID" header="Location" [style]="{'width':'15%'}"></p-column>
                  <p-column field="" header="Assigned" [style]="{'width':'20%'}">
                      <ng-template pTemplate="body" let-item="rowData">
                          {{ item.judicialOfficer?.firstName + ' ' + item.judicialOfficer?.lastName }}
                      </ng-template>
                  </p-column>
                  <p-column styleClass="col-button" header="View" [style]="{'width':'7%'}">
                      <ng-template let-item="rowData" pTemplate="body">
                          <i class="material-icons" (click)="requestViewHearing(item)">search</i>
                      </ng-template>
                  </p-column>
              </p-dataTable>

            </div>
            <div class="ui-g-12">
                <button type="button"
                    (click)="createHearing(hearingForm)"
                    label="Add Hearing"
                    icon="ui-icon-add"
                    class="ui-button-secondary mr-15" pButton></button>
            </div>
          </div>
        </p-tabPanel>

        <!-- JUDICIAL ASSIGNMENTS TAB -->

        <p-tabPanel header="Judicial Assignments" leftIcon="ui-icon-gavel" >
          <div class="ui-g">
            <div class="ui-g-12">
                <h2>Judicial Assignments</h2>
            </div>
            <div class="ui-g-12">
              <p-dataTable [value]="case.judicialAssignments"
                          selectionMode="single"
                          [(selection)]="selectedJudicialAssignment"
                          (onRowSelect)="judicialAssignmentOnRowSelect($event)"
                          dataKey="judicialAssignmentOID" #dtJudicialAssignment>
                <p-column field="" header="Start Date/Time" [style]="{'width':'20%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{item.startDate | date:'medium'}}
                    </ng-template>
                </p-column>
                <p-column field="" header="End Date/Time" [style]="{'width':'20%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{item.endDate | date:'medium'}}
                    </ng-template>
                </p-column>
                <p-column field="" header="Assigned" [style]="{'width':'17%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{ item.judicialOfficial?.firstName + ' ' + item.judicialOfficial?.lastName }}
                    </ng-template>
                </p-column>
                <p-column styleClass="col-button" header="View" [style]="{'width':'7%'}">
                    <ng-template let-item="rowData" pTemplate="body">
                        <i class="material-icons" (click)="requestViewJudicialAssignment(item)">search</i>
                    </ng-template>
                </p-column>
              </p-dataTable>
            </div>
            <div class="ui-g-12">
                <button type="button"
                    (click)="onAddJudge()"
                    label="Add Judge"
                    icon="ui-icon-add"
                    class="ui-button-secondary mr-15" pButton></button>
            </div>
          </div>
        </p-tabPanel>
      </p-tabView>

    </div>
  </div>
  <!-- //END SECOND CARD - TAB SECTION -->

</div>


<!--
  ----------------------------------
  MODALS
  ----------------------------------
 -->

 <!-- SAMPLE MODAL -->
 <!-- <p-dialog header="Title"
           [(visible)]="showDetailsModal"
           [modal]="true"
           [draggable]="false"
           [positionLeft]="0"
           [positionTop]="0"
           [blockScroll]="true"
           [closable]="false">
 </p-dialog> -->


<!-- REMOVE CHARGE CONFIRMATION MODAL -->

<p-dialog header="Confirm Delete?" width="450" [(visible)]="showDeleteChargeModal" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false">
    <div>Are you sure you want to delete this Charge?</div>
    <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix">
            <button label="No" type="button" pButton icon="fa-close" (click)="hideModals()" ></button>
            <button label="Yes"   type="button" pButton icon="fa-check" (click)="deleteCharge()" ></button>
        </div>
    </p-footer>
</p-dialog>

<!-- REMOVE PARTY CONFIRMATION MODAL -->

<p-dialog header="Confirm Delete?" width="450" [(visible)]="showDeletePartyModal" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false">
    <div>Are you sure you want to delete this Party?</div>
    <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix">
            <button label="No" type="button" pButton icon="fa-close" (click)="hideModals()" ></button>
            <button label="Yes"   type="button" pButton icon="fa-check" (click)="deleteParty()" ></button>
        </div>
    </p-footer>
</p-dialog>

<!-- ADD CASE PARTY MODAL -->

<p-dialog header="Add Case Party" styleClass="casePartyModal" width="700" [(visible)]="showModalAddCaseParty" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false">

  <p-tabView>

    <!-- TAB 1 of ADD CASE PARTY
     ------------ ADD EXISTING PARTY ----------------
    -->
    <p-tabPanel header="Existing Party">
      <form #casePartyForm="ngForm" novalidate>
        <div class="ui-g">
          <div class="form-group" >

            <div class="ui-g-12 ui-md-6">
              <div class="ui-inputgroup">
                  <span class="md-inputfield">
                      <input type="text" [(ngModel)]="partySearchText" name="tiPartySearch" pInputText>
                      <label>Search party name</label>
                  </span>
                  <button pButton type="button" (click)="searchForParty()" icon="ui-icon-search"></button>
              </div>
            </div>

            <div class="ui-g-12">
              <p-dataTable [value]="searchPartyResults"
                          selectionMode="single"
                          [(selection)]="selectedSearchParty"
                          scrollHeight="200px"
                          [scrollable]="true"
                          (onRowSelect)="searchPartyOnRowSelect($event)"
                          dataKey="partyOID" #dtSearchParty>
                <!-- <p-column header="Select" field="" [style]="{'width':'7%'}"></p-column> -->
                <p-column header="First Name" field="firstName" [style]="{'width':'15%'}"></p-column>
                <p-column header="Last Name" field="lastName" [style]="{'width':'15%'}"></p-column>
                <p-column header="DOB" field="dob" [style]="{'width':'15%'}">
                  <ng-template pTemplate="body" let-item="rowData">
                      {{item.dob | date:'M/d/yyyy'}}
                  </ng-template>
                </p-column>
                <p-column header="Age" field="" [style]="{'width':'15%'}">
                    <ng-template pTemplate="body" let-item="rowData">
                        {{ calculateAge(item) }}
                    </ng-template>
                </p-column>
                <p-column header="Sex" field="sex" [style]="{'width':'7%'}"></p-column>
              </p-dataTable>
            </div>

            <div *ngIf="selectedSearchParty">
              <div class="ui-g-12 mb-0">
                <h3 class="mb-0">{{selectedSearchParty.firstName}} {{selectedSearchParty.lastName}}</h3>
              </div>
              <div class="ui-g-12 mv-0">
                <label class="minimal primary block">Party Role</label>
                <p-dropdown name="ddPartyRole" id="ddPartyRole" #ddPartyRole="ngModel" placeholder="choose Party Role..."
                    [required]="true"
                    [options]="casePartyRoleTypes"
                    optionLabel="name"
                    [(ngModel)]="selectedSearchPartyRole"
                    (onChange)="searchPartyRoleTypeOnChange($event)"
                    styleClass="width-full">
                </p-dropdown>
                <div class="ui-message ui-messages-error ui-corner-all"
                      *ngIf="ddPartyRole.errors?.required && ddPartyRole.touched" >
                      Party Role is required
                </div>
              </div>

              <div class="ui-g-12 mb-0 pl-0">
                <div class="ui-g-12 ui-md-6 mb-0">
                  <label class="minimal primary block">Start Date</label>
                  <p-calendar id="dtStartDate" name="dtStartDate"
                        inputStyleClass="width-full"
                        [(ngModel)]="selectedSearchPartyStartDate"
                        dateFormat="mm/dd/yy"
                        placeholder="Start Date"
                        [showIcon]="true"
                        [yearNavigator]="true"
                        yearRange="2000:2030"
                        appendTo="body"></p-calendar>
                </div>
                <div class="ui-g-12 ui-md-6 mb-0">
                  <label class="minimal primary block">End Date</label>
                  <p-calendar id="dtEndDate" name="dtEndDate"
                        inputStyleClass="width-full"
                        [(ngModel)]="selectedSearchPartyEndDate"
                        dateFormat="mm/dd/yy"
                        placeholder="End Date"
                        [showIcon]="true"
                        [yearNavigator]="true"
                        yearRange="2000:2030"
                        appendTo="body"></p-calendar>
                </div>
              </div>
            </div>
          </div>
        </div>
        <p-footer>
          <div class="ui-dialog-buttonpane ui-helper-clearfix mt-30">
            <button label="Add Party To Case" type="submit" pButton icon="fa-check"
                    (click)="addPartyToCase(caseForm)"
                    [disabled]="!casePartyForm.form.valid || !selectedSearchParty"></button>
            <button label="Cancel" type="button" class="ui-button-secondary" pButton icon="fa-close"
                    (click)="hideModals()" ></button>
          </div>
        </p-footer>
      </form>
    </p-tabPanel>


    <!-- TAB 2 of ADD CASE PARTY
     ------------ CREATE NEW PARTY ----------------
    -->
    <p-tabPanel header="Create New Party">
      <form #newCasePartyForm="ngForm" novalidate>
        <div class="ui-g form-group" novalidate>

          <div  *ngIf="newCaseParty">

            <div class="ui-g-12 mb-20">
              <span class="md-inputfield">
                <input pInputText type="text" #newCPfName="ngModel" required name="newCPfName"
                        [ngModel]="newCaseParty.caseParty?.firstName" (ngModelChange)="newCPfNameChanged($event)">
                <label>First Name</label>
              </span>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="newCPfName.errors?.required && newCPfName.touched" >
                    Please enter First Name
              </div>
            </div>

            <div class="ui-g-12 mb-20">
              <span class="md-inputfield">
                <input type="text" pInputText #newCPlName="ngModel" name="newCPlName" required
                        [ngModel]="newCaseParty.caseParty?.lastName"  (ngModelChange)="newCPlNameChanged($event)">
                <label>Last Name</label>
              </span>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="newCPlName.errors?.required && newCPlName.touched" >
                    Please enter Last Name
              </div>
            </div>

            <div class="ui-g-12 mb-0">
              <span class="md-inputfield">
                <input type="text" pInputText name="newCPaltName"
                        [ngModel]="newCaseParty.caseParty?.alternativeName" (ngModelChange)="newCPaltNameChanged($event)">
                <label>Alternative Name</label>
              </span>
            </div>


            <div class="ui-g-12 mb-0 pl-0">
              <div class="ui-g-12 ui-md-6 mb-0">
                <label class="minimal primary block">Date of Birth</label>
                <p-calendar id="newCPdob" name="newCPdob" #newCPdob="ngModel"
                      [required]="true"
                      inputStyleClass="width-full"
                      [ngModel]="newCaseParty.caseParty?.dob"
                      (ngModelChange)="newCPdobChange($event)"
                      dateFormat="mm/dd/yy"
                      placeholder="Date of Birth"
                      [showIcon]="true"
                      [yearNavigator]="true"
                      yearRange="1900:2020"
                      appendTo="body"></p-calendar>
                <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="newCPdob.errors?.required && newCPdob.touched" >
                  Please enter a Date of Birth
                </div>
              </div>

              <div class="ui-g-12 ui-md-6 mb-0">
                <label class="minimal primary block">Sex</label>
                  <p-dropdown name="newCPsex" #newCPsex="ngModel" placeholder="choose gender"
                      [required]="true"
                      [options]="genderTypes"
                      [ngModel]="newCaseParty.caseParty?.sex"
                      (ngModelChange)="newCPsexChange($event)"
                      styleClass="width-auto">
                  </p-dropdown>
                  <div class="ui-message ui-messages-error ui-corner-all"
                        *ngIf="newCPsex.errors?.required && newCPsex.touched" >
                    Please enter a gender
                  </div>
              </div>
            </div>

            <div class="ui-g-12 mb-0">
                <label class="minimal primary block">Party Role</label>
                <p-dropdown name="ddNewPartyRole" #ddNewPartyRole="ngModel" placeholder="choose Party Role..."
                    [required]="true"
                    [options]="casePartyRoleTypes"
                    optionLabel="name"
                    [(ngModel)]="newCaseParty.role"
                    (onChange)="newCasePartyRoleTypeOnChange($event)"
                    styleClass="width-full">
                </p-dropdown>
                <div class="ui-message ui-messages-error ui-corner-all"
                      *ngIf="ddNewPartyRole.errors?.required && ddNewPartyRole.touched" >
                      Party Role is required
                </div>
            </div>

            <!-- column 3 -->
            <div class="ui-g-12 mb-0 pl-0">
              <div class="ui-g-12 ui-md-6 mb-0">
                <label class="minimal primary block">Start Date</label>
                <p-calendar id="dtStartDate" name="dtStartDate"
                      inputStyleClass="width-full"
                      [(ngModel)]="newCaseParty.startDate"
                      dateFormat="mm/dd/yy"
                      placeholder="Start Date"
                      [showIcon]="true"
                      [yearNavigator]="true"
                      yearRange="2000:2030"
                      appendTo="body"></p-calendar>
              </div>
              <div class="ui-g-12 ui-md-6 mb-0">
                <label class="minimal primary block">End Date</label>
                <p-calendar id="dtEndDate" name="dtEndDate"
                      inputStyleClass="width-full"
                      [(ngModel)]="newCaseParty.endDate"
                      dateFormat="mm/dd/yy"
                      placeholder="End Date"
                      [showIcon]="true"
                      [yearNavigator]="true"
                      yearRange="2000:2030"
                      appendTo="body"></p-calendar>
              </div>
            </div>
          </div>
        </div>
        <p-footer>
          <div class="ui-dialog-buttonpane ui-helper-clearfix mt-30 ta-r">
            <button label="Create and Add Party To Case" type="submit" pButton icon="fa-check"
                    (click)="createAndAddPartyToCase(caseForm)"
                    [disabled]="!newCasePartyForm.form.valid || !newCaseParty"></button>
            <button label="Cancel" type="button" class="ui-button-secondary mr-15" pButton icon="fa-close"
                    (click)="hideModals()" ></button>
          </div>
        </p-footer>

      </form>
    </p-tabPanel>

  </p-tabView>
</p-dialog>

<!-- DIALOG CASE PARTY
  ------------ EDIT PARTY ----------------
-->
<p-dialog header="Edit Party" width="450" [(visible)]="showModalEditCaseParty" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false">
    <form #editCasePartyForm="ngForm" novalidate>
      <div class="ui-g form-group" novalidate>

        <div  *ngIf="selectedCaseParty">

          <div class="ui-g-12 mb-20">
            <span class="md-inputfield">
              <input pInputText type="text" #editCPfName="ngModel" required name="editCPfName"
                      [ngModel]="selectedCaseParty.caseParty?.firstName" (ngModelChange)="editCPfNameChanged($event)">
              <label>First Name</label>
            </span>
            <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="editCPfName.errors?.required && editCPfName.touched" >
                  Please enter First Name
            </div>
          </div>

          <div class="ui-g-12 mb-20">
            <span class="md-inputfield">
              <input type="text" pInputText #editCPlName="ngModel" name="editCPlName" required
                      [ngModel]="selectedCaseParty.caseParty?.lastName"  (ngModelChange)="editCPlNameChanged($event)">
              <label>Last Name</label>
            </span>
            <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="editCPlName.errors?.required && editCPlName.touched" >
                  Please enter Last Name
            </div>
          </div>

          <div class="ui-g-12 mb-0">
            <span class="md-inputfield">
              <input type="text" pInputText name="editCPaltName"
                      [ngModel]="selectedCaseParty.caseParty?.alternativeName" (ngModelChange)="editCPaltNameChanged($event)">
              <label>Alternative Name</label>
            </span>
          </div>


          <div class="ui-g-12 mb-0 pl-0">
            <div class="ui-g-12 ui-md-6 mb-0">
              <label class="minimal primary block">Date of Birth</label>
              <p-calendar id="editCPdob" name="editCPdob" #editCPdob="ngModel"
                    [required]="true"
                    inputStyleClass="width-full"
                    [ngModel]="selectedCaseParty.caseParty?.dob"
                    (ngModelChange)="editCPdobChange($event)"
                    dateFormat="mm/dd/yy"
                    placeholder="Date of Birth"
                    [showIcon]="true"
                    [yearNavigator]="true"
                    yearRange="1900:2020"
                    appendTo="body"></p-calendar>
              <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="editCPdob.errors?.required && editCPdob.touched" >
                Please enter a Date of Birth
              </div>
            </div>

            <div class="ui-g-12 ui-md-6 mb-0">
              <label class="minimal primary block">Sex</label>
                <p-dropdown name="editCPsex" #editCPsex="ngModel" placeholder="choose gender"
                    [required]="true"
                    [options]="genderTypes"
                    [ngModel]="selectedCaseParty.caseParty?.sex"
                    (ngModelChange)="editCPsexChange($event)"
                    styleClass="width-auto">
                </p-dropdown>
                <div class="ui-message ui-messages-error ui-corner-all"
                      *ngIf="editCPsex.errors?.required && editCPsex.touched" >
                  Please enter a gender
                </div>
            </div>
          </div>

          <div class="ui-g-12 mb-0">
              <label class="minimal primary block">Party Role</label>
              <p-dropdown name="ddNewPartyRole" #ddNewPartyRole="ngModel" placeholder="choose Party Role..."
                  [required]="true"
                  [options]="casePartyRoleTypes"
                  optionLabel="name"
                  [(ngModel)]="selectedCaseParty.role"
                  (onChange)="editCasePartyRoleTypeOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="ddNewPartyRole.errors?.required && ddNewPartyRole.touched" >
                    Party Role is required
              </div>
          </div>

          <!-- column 3 -->
          <div class="ui-g-12 mb-0 pl-0">
            <div class="ui-g-12 ui-md-6 mb-0">
              <label class="minimal primary block">Start Date</label>
              <p-calendar id="dtStartDate" name="dtStartDate"
                    inputStyleClass="width-full"
                    [(ngModel)]="selectedCaseParty.startDate"
                    dateFormat="mm/dd/yy"
                    placeholder="Start Date"
                    [showIcon]="true"
                    [yearNavigator]="true"
                    yearRange="2000:2030"
                    appendTo="body"></p-calendar>
            </div>
            <div class="ui-g-12 ui-md-6 mb-0">
              <label class="minimal primary block">End Date</label>
              <p-calendar id="dtEndDate" name="dtEndDate"
                    inputStyleClass="width-full"
                    [(ngModel)]="selectedCaseParty.endDate"
                    dateFormat="mm/dd/yy"
                    placeholder="End Date"
                    [showIcon]="true"
                    [yearNavigator]="true"
                    yearRange="2000:2030"
                    appendTo="body"></p-calendar>
            </div>
          </div>
        </div>
      </div>
      <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix mt-30 ta-r">
          <button label="Edit Party" type="submit" pButton icon="fa-check"
                  (click)="editParty()"
                  [disabled]="!editCasePartyForm.form.valid || !selectedCaseParty"></button>
          <button label="Cancel" type="button" class="ui-button-secondary mr-15" pButton icon="fa-close"
                  (click)="hideModals()" ></button>
        </div>
      </p-footer>

    </form>

</p-dialog>


<!-- ADD CASE CHARGE MODAL -->

<p-dialog header="Add Case Charge" width="580" [(visible)]="showModalAddCaseCharge" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false">
  <form  #caseChargeForm="ngForm" novalidate><!-- (ngSubmit)="saveCaseCharge()" -->
    <div class="ui-g">
      <div class="form-group" >

        <div class="ui-g-12 mb-0">
          <label class="minimal primary block">Section</label>
          <p-dropdown name="ddSection" id="ddSection" #ddSection="ngModel" placeholder="choose Section..."
              [required]="true"
              [options]="sectionTypes"
              optionLabel="categoryName"
              [(ngModel)]="selectedSectionType"
              (onChange)="sectionTypeOnChange($event)"
              styleClass="width-full">
          </p-dropdown>
          <div class="ui-message ui-messages-error ui-corner-all"
                *ngIf="ddSection.errors?.required && ddSection.touched" >
                Section is required
          </div>
        </div>

        <div class="ui-g-12 mb-0">
            <label class="minimal primary block">Division</label>
            <p-dropdown name="ddDivision" id="ddDivision" placeholder="choose Division..."
                [options]="divisionTypes"
                optionLabel="categoryName"
                [(ngModel)]="selectedDivisionType"
                (onChange)="divisionTypeOnChange($event)"
                styleClass="width-full">
            </p-dropdown>
        </div>

        <div class="ui-g-12 mb-0">
          <label class="minimal primary block">Group</label>
          <p-dropdown name="ddGroup" placeholder="choose Group..."
              [options]="groupTypes"
              optionLabel="categoryName"
              [(ngModel)]="selectedGroupType"
              (onChange)="groupTypeOnChange($event)"
              styleClass="width-full">
          </p-dropdown>
        </div>

        <div class="ui-g-12 mb-0">
          <label class="minimal primary block">Class</label>
          <p-dropdown name="ddClass" placeholder="choose Class..."
              [options]="classTypes"
              optionLabel="categoryName"
              [(ngModel)]="selectedClassType"
              (onChange)="classTypeOnChange($event)"
              styleClass="width-full">
          </p-dropdown>
        </div>

        <div class="ui-g-12 mb-0">
          <label class="minimal primary block">Charge/Law</label>
          <p-dropdown name="ddChargeLaw" id="ddChargeLaw" #ddChargeLaw="ngModel" placeholder="choose Charge/Law..."
              [required]="lastSelectedTypeLocalCharges.length > 0 ? true : undefined"
              [options]="chargeLawTypes"
              optionLabel="localCharge"
              [(ngModel)]="selectedChargeLawType"
              (onChange)="chargeLawTypeOnChange($event)"
              styleClass="width-full">
          </p-dropdown>
          <div class="ui-message ui-messages-error ui-corner-all"
                *ngIf="ddChargeLaw.errors?.required && ddChargeLaw.touched" >
                Charge/Law is required
          </div>
        </div>

        <div class="ui-g-12">
          <label class="minimal primary block" for="tiLea">LEA Lead Charge</label>
          <textarea id="tiLea" name="tiLea" #tiLea="ngModel"
                    [required]="true"
                    [(ngModel)]="leaLeadChargeText"
                    [rows]="2"
                    pInputTextarea
                    autoResize="autoResize"
                    class="width-full"></textarea>
          <div class="ui-message ui-messages-error ui-corner-all"
                *ngIf="tiLea.errors?.required && tiLea.touched" >
                LEA Lead Charge is required
          </div>
        </div>

        <div class="ui-g-12 ">
          <label class="minimal primary block">Charge Factors</label>
          <span class="ui-fluid">
            <p-autoComplete name="acChargeFactors"
                field="description"
                [(ngModel)]="selectedChargeFactors"
                [suggestions]="filteredChargeFactorTypes"
                (completeMethod)="getChargeFactorsToFilter($event)"
                styleClass="width-full"
                [minLength]="1"
                placeholder="select Charge Factors"
                [dropdown]="true"
                appendTo="body"
                [multiple]="true">
            </p-autoComplete>
          </span>
        </div>

      </div>
    </div>

    <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix mt-30">
          <button label="Save" type="submit" pButton icon="fa-check"
                  (click)="saveCaseCharge()"
                  [disabled]="!caseChargeForm.form.valid"></button>
          <button label="Cancel" class="ui-button-secondary" type="button" pButton icon="fa-close" (click)="hideModals()" ></button>
        </div>
    </p-footer>

  </form>
</p-dialog>



<!-- ADD CASE TASK MODAL -->

<p-dialog header="Add Case Task" width="450" [(visible)]="showModalAddCaseTask" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false">
  <loading-bar [visible]="loadingCaseTaskLookups" [message]="'loading task data...'"></loading-bar>

  <form (ngSubmit)="saveCaseTask()" #caseTaskForm="ngForm" novalidate>
    <div class="ui-g">
      <div class="form-group" >

        <div class="ui-g-12 mb-0">
          <label class="minimal primary block">Task Type</label>
          <p-dropdown name="ddTaskType" id="ddTaskType" #ddTaskType="ngModel" placeholder="choose Task Type..."
              [required]="true"
              [options]="taskTypes"
              optionLabel="name"
              [ngModel]="selectedCaseTask?.taskType"
              (onChange)="taskTypeOnChange($event)"
              styleClass="width-full">
          </p-dropdown>
          <div class="ui-message ui-messages-error ui-corner-all"
                *ngIf="ddTaskType.errors?.required && ddTaskType.touched" >
                Task Type is required
          </div>
        </div>

        <div class="ui-g-12 mb-0">
            <label class="minimal primary block">Priority</label>
            <p-dropdown name="ddPriority" id="ddPriority" placeholder="choose Priority..."
                [options]="priorityTypes"
                [ngModel]="selectedCaseTask?.taskPriorityCode"
                (onChange)="priorityTypeOnChange($event)"
                styleClass="width-full">
            </p-dropdown>
        </div>

        <div class="ui-g-12 mb-0">
          <label class="minimal primary block">Assigned Person</label>
          <p-dropdown name="ddAssignedPerson" id="ddAssignedPerson"
              [options]="taskParties | dropdownPipe: ['firstName', 'lastName'] : 'partyOID' : 'choose Assigned Person...'"
              [ngModel]="selectedCaseTask?.assignedParty?.partyOID"
              (onChange)="assignedPersonTypeOnChange($event)"
              styleClass="width-full">
          </p-dropdown>
        </div>

        <div class="ui-g-12 mb-0">
          <label class="minimal primary block">Assigned Staff Pool</label>
          <p-dropdown name="ddStaffPool" placeholder="choose Staff Pool..."
              [options]="staffPools"
              optionLabel="poolName"
              [ngModel]="selectedCaseTask?.assignedPool"
              (onChange)="staffPoolTypeOnChange($event)"
              styleClass="width-full">
          </p-dropdown>
        </div>

        <!-- DUE DATE -->
        <div class="ui-g-12">
          <label class="minimal primary block">Due Date</label>
          <p-calendar id="task_dueDate" name="task_dueDate" placeholder="Due Date"
              [ngModel]="selectedCaseTask?.dueDate"
              (ngModelChange)="dueDateOnChange($event)"
              [showIcon]="true"
              dateFormat="mm/dd/yy"
              appendTo="body"></p-calendar>
        </div>

        <!-- DONE DATE -->
        <div class="ui-g-12" *ngIf="selectedCaseTask && selectedCaseTask.taskOID > 0">
          <label class="minimal primary block">Done Date</label>
          <p-calendar id="task_doneDate" name="task_doneDate" placeholder="Done Date"
              [ngModel]="selectedCaseTask?.doneDate"
              (ngModelChange)="doneDateOnChange($event)"
              [showIcon]="true"
              dateFormat="mm/dd/yy"
              appendTo="body"></p-calendar>
        </div>

        <div class="ui-g-12">
          <label class="minimal primary block" for="tiTaskDetails">Task Details</label>
          <textarea id="tiTaskDetails" name="tiTaskDetails"
                    [ngModel]="selectedCaseTask?.details"
                    (ngModelChange)="taskDetailsOnChange($event)"
                    [rows]="2"
                    pInputTextarea
                    autoResize="autoResize"
                    class="width-full"></textarea>
        </div>
      </div>
    </div>

    <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix mt-30">
          <button label="Save Task" type="submit" pButton icon="fa-check" [disabled]="!caseTaskForm.form.valid"></button>
          <button label="Cancel" class="ui-button-secondary" type="button" pButton icon="fa-close"
                  (click)="onCancelCaseTask(caseTaskForm)" ></button>
        </div>
    </p-footer>

  </form>
</p-dialog>




  <!-- ADD JUDICIAL ASSIGNMENT MODAL -->

  <p-dialog header="Add Judicial Assignment" width="450" [(visible)]="showModalAddJudge" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false">
    <loading-bar [visible]="loadingJudgeLookups" [message]="'loading judicial data...'"></loading-bar>
    <form (ngSubmit)="saveJudge()" #caseJudgeForm="ngForm" novalidate>
      <div class="ui-g">
        <div class="form-group" >

          <div class="ui-g-12 mb-15">
            <label class="minimal primary block">Judge</label>
            <div *ngIf="judge.judicialAssignmentOID > 0">{{judge.judicialOfficial.name}}</div>
            <div *ngIf="!judge.judicialAssignmentOID || judge.judicialAssignmentOID == 0">
              <p-dropdown name="ddJudge" id="ddJudge" placeholder="choose Judge..." #ddJudge="ngModel"
                  [required]="true"
                  [options]="judges"
                  optionLabel="name"
                  [(ngModel)]="judge.judicialOfficial"
                  [disabled]="judge.judicialAssignmentOID > 0"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="ddJudge.errors?.required && ddJudge.touched" >
                    Please select a Judge
              </div>
            </div>
          </div>

          <!-- START DATE -->
          <div class="ui-g-12 mb-15">
            <p-calendar id="dtStartDate" name="dtStartDate" placeholder="Start Date" #dtStartDate="ngModel"
                [(ngModel)]="judge.startDate"
                [showIcon]="true"
                dateFormat="mm/dd/yy"
                appendTo="body"></p-calendar>
            <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="dtStartDate.errors?.required && dtStartDate.touched" >
                  Please select a start date
            </div>
          </div>

          <!-- END DATE -->
          <div class="ui-g-12">
            <p-calendar id="dtEndDate" name="dtEndDate" placeholder="End Date" #dtEndDate="ngModel"
                [(ngModel)]="judge.endDate"
                [showIcon]="true"
                dateFormat="mm/dd/yy"
                appendTo="body"></p-calendar>
          </div>

        </div>
      </div>

      <p-footer>
          <div class="ui-dialog-buttonpane ui-helper-clearfix mt-30">
            <button label="Add Judge" type="submit" pButton icon="fa-check" [disabled]="!caseJudgeForm.form.valid"></button>
            <button label="Cancel" class="ui-button-secondary" type="button" pButton icon="fa-close" (click)="hideModals()" ></button>
          </div>
      </p-footer>

    </form>
  </p-dialog>



  <!-- ADD EVENT MODAL -->

  <p-dialog header="Add Completed Event" width="450" [(visible)]="showModalAddEvent" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false">
    <form (ngSubmit)="saveEvent()" #caseEventForm="ngForm" novalidate>
      <div class="ui-g">
        <div class="form-group" >

          <!-- EVENT DATE -->
          <div class="ui-g-12">
            <label class="minimal primary block">Event ID</label>
            <p-calendar id="dtEventDate" name="dtEventDate" placeholder="Event Date" #dtEventDate="ngModel"
                [(ngModel)]="caseEvent.eventDate"
                [showIcon]="true"
                dateFormat="mm/dd/yy"
                [disabled]="caseEvent.caseEventOID && caseEvent.caseEventOID > 0"
                appendTo="body"></p-calendar>
            <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="dtEventDate.errors?.required && dtEventDate.touched" >
                  Please select a event date
            </div>
          </div>

          <!-- EVENT ID -->
          <div class="ui-g-12 mb-15">
            <label class="minimal primary block">Event ID</label>
            <p-dropdown name="ddEventId" id="ddEventId" placeholder="choose Event ID..." #ddEventId="ngModel"
                [required]="true"
                [options]="eventTypes"
                optionLabel="eventTypeName"
                [(ngModel)]="caseEvent.eventType"
                [disabled]="caseEvent.caseEventOID && caseEvent.caseEventOID > 0"
                styleClass="width-full">
            </p-dropdown>
            <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="ddEventId.errors?.required && ddEventId.touched" >
                  Please select an Event
            </div>
          </div>

          <div class="ui-md-12" *ngIf="caseEvent.caseEventOID && caseEvent.caseEventOID > 0">
            <label class="minimal primary block">Event Category</label>
            <div>{{caseEvent.eventType?.eventCategoryText}}</div>
          </div>

          <!-- INITIATED BY -->
          <div class="ui-g-12">
            <label class="minimal primary block">Event Initiated By</label>
            <p-dropdown name="ddInitiator" id="ddInitiator" placeholder="choose initiator..." #ddInitiator="ngModel"
                [required]="true"
                [options]="case?.caseParties"
                optionLabel="caseParty.lastName"
                [(ngModel)]="selectedInitiatedByParty"
                [disabled]="caseEvent.caseEventOID && caseEvent.caseEventOID > 0"
                styleClass="width-full">
            </p-dropdown>
            <label class="minimal block"
                 *ngIf="caseEvent.caseEventOID && caseEvent.caseEventOID > 0">
                      [Awaiting property 'initatedBy' on Case > CaseEvent returned from server]
            </label>
            <div class="ui-message ui-messages-error ui-corner-all"
                  *ngIf="ddInitiator.errors?.required && ddInitiator.touched" >
                  Please select Initiator of the Event
            </div>
          </div>

          <!-- ENTERED BY -->
          <div class="ui-g-12 mb-15" *ngIf="caseEvent.caseEventOID && caseEvent.caseEventOID > 0">
            <label class="minimal primary block">Event Entered by:</label>
            <div>{{caseEvent.enteringParty?.firstName}} {{caseEvent.enteringParty?.lastName}}</div>
          </div>

          <!-- DURATION -->
          <div class="ui-g-12 mt-15">
            <span class="md-inputfield">
              <input pInputText id="tiEventDuration" name="tiEventDuration" class="width-full"
                      [(ngModel)]="caseEvent.durationTimeMin"/>
              <label>Event Duration (Min)</label>
            </span>
          </div>

          <!-- EVENT DOCUMENT -->
          <div class="ui-g-12">
            <label class="minimal primary block">Document</label>
            <p-dropdown name="ddDocuments" id="ddDocuments" placeholder="choose Document..."
                [required]="true"
                [options]="documentTemplateTypes"
                optionLabel="documentName"
                [(ngModel)]="caseEvent.docTemplate"
                styleClass="width-full">
            </p-dropdown>
          </div>

          <!-- EVENT DETAILS  -->
          <div class="ui-g-12 mt-15">
            <span class="md-inputfield">
              <input pInputText id="tiEventDesc" name="tiEventDesc" class="width-full"
                      [(ngModel)]="caseEvent.description"/>
              <label>Event Details</label>
            </span>
          </div>

        </div>
      </div>

      <p-footer>
          <div class="ui-dialog-buttonpane ui-helper-clearfix mt-30">
            <button label="Add Case Event" type="submit" pButton icon="fa-check" [disabled]="!caseEventForm.form.valid" ></button>
            <button label="Cancel" class="ui-button-secondary" type="button" pButton icon="fa-close" (click)="hideModals()" ></button>
          </div>
      </p-footer>

    </form>
  </p-dialog>


  <!-- ADD HEARING MODAL -->

  <p-dialog header="Add Hearing" width="600" [(visible)]="showModalAddHearing" [responsive]="true" showEffect="fade" [modal]="true" [closable]="false" [blockScroll]="true">
    <loading-bar [visible]="loadingHearingLookups" [message]="'loading hearing data...'"></loading-bar>

    <form (ngSubmit)="saveHearing()" #hearingForm="ngForm" novalidate>
      <div class="ui-g">
        <div class="form-group" >

          <div class="ui-g-12 ph-0">
            <div class="ui-g-5">
              <!-- HEARING DATE -->
                <label class="minimal primary block">Hearing Date</label>
                <p-calendar id="hearingDate" name="hearingDate" #hearingDate="ngModel" placeholder="Hearing Date"
                    [ngModel]="selectedHearing?.startDateTime"
                    (ngModelChange)="hearingDateOnChange($event)"
                    [showIcon]="true"
                    dateFormat="mm/dd/yy"
                    appendTo="body"></p-calendar>
                <div class="ui-message ui-messages-error ui-corner-all"
                     *ngIf="hearingDate.errors?.required && hearingDate.touched" >
                     Please choose a Hearing Date
                </div>
            </div>
            <div class="ui-g-7">
              <label class="minimal primary block">Judicial Officer</label>
              <p-dropdown name="ddHearingJudge" id="ddHearingJudge" #ddHearingJudge="ngModel" placeholder="choose Judgicial Officer..."
                  [required]="true"
                  [options]="judges | dropdownPipe: ['firstName', 'lastName'] : 'partyOID' : 'choose Judge...'"
                  [ngModel]="selectedHearing?.judicialOfficer?.partyOID"
                  (onChange)="hearingJudgeOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="ddHearingJudge.errors?.required && ddHearingJudge.touched" >
                    Please select a Judicial Officer
              </div>
            </div>
          </div>

          <!-- CONFLICT TABLE HERE -->

          <div class="ui-g-12">
            <p-panel [toggleable]="true" [collapsed]="!hearingConflicts || hearingConflicts.length < 1" class="conflict-table">
              <p-header >
                <span>
                  {{ hearingConflicts?.length || 0 }} Potential Schedule Conflicts: {{selectedHearing?.startDateTime | date: 'MM/dd/yy' }}
                </span>
                <span *ngIf="loadingConflicts" class="mt-10">
                    <p-progressSpinner strokeWidth="3" [style]="{width: '24px', height: '24px'}"></p-progressSpinner>
                </span>
              </p-header>
              <p-dataTable [value]="hearingConflicts"
                  selectionMode="single"
                  [(selection)]="selectedHearing"
                  (onRowSelect)="hearingConflictsOnRowSelect($event)"
                  dataKey="caseOID" #dtHearingResults>

                <p-column header="Start/End Times" [style]="{'width':'30%'}">
                    <ng-template let-item="rowData" pTemplate="body">
                      <div>{{item.startDateTime | date: 'MM/dd/yy hh:mm a'}}</div>
                      <div>{{item.endDateTime | date: 'MM/dd/yy hh:mm a'}}</div>
                    </ng-template>
                  </p-column>

                <p-column header="Case Number" field="associatedCase.caseNumber" [style]="{'width':'20%'}"></p-column>
                <p-column header="Hearing Type" field="hearingType.hearingName" [style]="{'width':'15%'}"></p-column>
                <p-column header="Location" field="courtLoc.locationID" [style]="{'width':'15%'}"></p-column>
                <p-column header="Assigned" [style]="{'width':'20%'}">
                  <ng-template let-item="rowData" pTemplate="body">
                    {{item.judicialOfficer?.firstName}} {{item.judicialOfficer?.lastName}}
                  </ng-template>
                </p-column>
              </p-dataTable>
            </p-panel>
          </div>

          <div class="ui-g-12 ph-0">
            <div class="ui-g-12 ui-md-6 ta-r">
                <label class="minimal primary block ta-c">Start Time</label>
                <p-calendar id="hearingStartTime" name="hearingStartTime" #hearingStartTime="ngModel" placeholder="Start Time"
                    [ngModel]="selectedHearing?.startDateTime"
                    (ngModelChange)="hearingStartTimeOnChange($event)"
                    [inline]="true"
                    hourFormat="12"
                    [timeOnly]="true"
                    class="time-picker"></p-calendar>
                <div class="ui-message ui-messages-error ui-corner-all"
                     *ngIf="hearingStartTime.errors?.required && hearingStartTime.touched" >
                     Please choose a Start Time
                </div>
            </div>

            <div class="ui-g-12 ui-md-6">
              <label class="minimal primary block ta-c">End Time</label>
              <p-calendar id="hearingEndTime" name="hearingEndTime" #hearingEndTime="ngModel" placeholder="End Time"
                  [ngModel]="selectedHearing?.endDateTime"
                  (ngModelChange)="hearingEndTimeOnChange($event)"
                  [inline]="true"
                  hourFormat="12"
                  [timeOnly]="true"
                  class="time-picker"></p-calendar>
              <div class="ui-message ui-messages-error ui-corner-all"
                   *ngIf="hearingEndTime.errors?.required && hearingEndTime.touched" >
                   Please choose a End Time
              </div>
            </div>
          </div>

          <div class="ui-g-12 pd-v-0">
            <div class="ui-g-6 mb-0">
              <label class="minimal primary block">Hearing Location</label>
              <p-dropdown name="ddHearingLocation" id="ddHearingLocation" #ddHearingLocation="ngModel" placeholder="choose Hearing Location..."
                  [required]="true"
                  [options]="hearingLocations"
                  optionLabel="locationID"
                  [ngModel]="selectedHearing?.courtLoc"
                  (onChange)="hearingLocationOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="ddHearingLocation.errors?.required && ddHearingLocation.touched" >
                    Please choose a Hearing Location
              </div>
            </div>
            <div class="ui-g-6 mb-0">
              <label class="minimal primary block">Hearing Type</label>
              <p-dropdown name="ddHearingType" id="ddHearingType" #ddHearingType="ngModel" placeholder="choose Hearing Type..."
                  [required]="true"
                  [options]="hearingTypes"
                  optionLabel="hearingName"
                  [ngModel]="selectedHearing?.hearingType"
                  (onChange)="hearingTypeOnChange($event)"
                  styleClass="width-full">
              </p-dropdown>
              <div class="ui-message ui-messages-error ui-corner-all"
                    *ngIf="ddHearingType.errors?.required && ddHearingType.touched" >
                    Please choose a Hearing Location
              </div>
            </div>
          </div>

          <div class="ui-g-12">
            <label class="minimal primary block">Description</label>
            <textarea name="tiHearingDescription"
                      [ngModel]="selectedHearing?.description"
                      (ngModelChange)="hearingDescriptionOnChange($event)"
                      [rows]="2"
                      pInputTextarea
                      autoResize="autoResize"
                      class="width-full"></textarea>
          </div>
        </div>
      </div>

      <p-footer>
          <div class="ui-dialog-buttonpane ui-helper-clearfix mt-30">
            <button label="Save Hearing" type="submit" pButton icon="fa-check" [disabled]="!hearingForm.form.valid"></button>
            <button label="Cancel" class="ui-button-secondary" type="button" pButton icon="fa-close"
                    (click)="onCancelHearing(hearingForm)" ></button>
          </div>
      </p-footer>

    </form>
  </p-dialog>
